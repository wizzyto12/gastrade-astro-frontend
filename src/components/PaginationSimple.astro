---
interface Props {
    page: number;
    totalPages: number;
    basePath?: string;
}

const { page, totalPages, basePath = "/installations" } = Astro.props as Props;

function generatePaginationRange(currentPage: number, total: number, delta = 2) {
    const range: Array<number | string> = [];

    for (let i = 1; i <= total; i += 1) {
        if (i === 1 || i === total || (i >= currentPage - delta && i <= currentPage + delta)) {
            range.push(i);
        } else if (range[range.length - 1] !== "...") {
            range.push("...");
        }
    }

    return range;
}

const paginationRange = generatePaginationRange(page, totalPages);
---

{totalPages > 1 && (
    <nav class="mt-12 flex flex-wrap items-center justify-between gap-4 rounded-2xl border border-zinc-200 bg-white px-6 py-4 shadow-sm">
        <a
            href={page > 1 ? `${basePath}?page=${page - 1}` : undefined}
            class={`inline-flex items-center gap-2 text-sm font-semibold transition ${page > 1 ? "text-zinc-900 hover:text-violet-700" : "pointer-events-none text-zinc-400"}`}
            aria-disabled={page <= 1}
        >
            <svg class="size-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                <path
                    fill-rule="evenodd"
                    d="M12.79 4.23a.75.75 0 0 1 0 1.06L8.56 9.52l4.23 4.23a.75.75 0 1 1-1.06 1.06l-4.76-4.76a.75.75 0 0 1 0-1.06l4.76-4.76a.75.75 0 0 1 1.06 0Z"
                    clip-rule="evenodd"
                />
            </svg>
            Предишна
        </a>

        <div class="flex flex-wrap justify-center gap-2 text-sm font-medium">
            {paginationRange.map((pageNumber) => (
                pageNumber === "..." ? (
                    <span class="inline-flex size-10 items-center justify-center rounded-full bg-transparent text-zinc-400">…</span>
                ) : (
                    <a
                        href={`${basePath}?page=${pageNumber}`}
                        class={`inline-flex size-10 items-center justify-center rounded-full transition ${pageNumber === page ? "bg-violet-700 text-white" : "bg-zinc-100 text-zinc-700 hover:bg-violet-100"}`}
                        aria-current={pageNumber === page ? "page" : undefined}
                    >
                        {pageNumber}
                    </a>
                )
            ))}
        </div>

        <a
            href={page < totalPages ? `${basePath}?page=${page + 1}` : undefined}
            class={`inline-flex items-center gap-2 text-sm font-semibold transition ${page < totalPages ? "text-zinc-900 hover:text-violet-700" : "pointer-events-none text-zinc-400"}`}
            aria-disabled={page >= totalPages}
        >
            Следваща
            <svg class="size-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                <path
                    fill-rule="evenodd"
                    d="M7.21 4.23a.75.75 0 0 1 1.06 0l4.76 4.76a.75.75 0 0 1 0 1.06l-4.76 4.76a.75.75 0 1 1-1.06-1.06l4.23-4.23-4.23-4.23a.75.75 0 0 1 0-1.06Z"
                    clip-rule="evenodd"
                />
            </svg>
        </a>
    </nav>
)}
